<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="images/favicon.png" />
<title>Text Mining the Human Behavioral Ecology Bibliography | Bret Alexander Beheim</title>
<meta name="title" content="Text Mining the Human Behavioral Ecology Bibliography" />
<meta name="description" content="Thanks to Kermyt Anderson, the Human Behavioral Ecology Bibliography (HBEB) has recently gone online. Eleanor Power has taken this text file and parsed it into a bibtex file, and from there it can be turned into an Endnote library or other bibliographic database format.
I&rsquo;m curious to know more about HBEB&rsquo;s use as a dataset in its own right, and since I&rsquo;ve been doing similar work with our field data here at MPI-EVA&rsquo;s new Department of Human Behavior, Ecology and Culture, I figured I could turn the lens on us at the same time as showcase the methods to interested parties." />
<meta name="keywords" content="" />


<meta property="og:title" content="Text Mining the Human Behavioral Ecology Bibliography" />
<meta property="og:description" content="Thanks to Kermyt Anderson, the Human Behavioral Ecology Bibliography (HBEB) has recently gone online. Eleanor Power has taken this text file and parsed it into a bibtex file, and from there it can be turned into an Endnote library or other bibliographic database format.
I&rsquo;m curious to know more about HBEB&rsquo;s use as a dataset in its own right, and since I&rsquo;ve been doing similar work with our field data here at MPI-EVA&rsquo;s new Department of Human Behavior, Ecology and Culture, I figured I could turn the lens on us at the same time as showcase the methods to interested parties." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2017-06-15-text-mining-the-hbeb/" /><meta property="og:image" content="images/bret-head.jpg"/><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2017-06-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2017-06-15T00:00:00+00:00" /><meta property="og:site_name" content="Bret Alexander Beheim" />




<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="images/bret-head.jpg"/>

<meta name="twitter:title" content="Text Mining the Human Behavioral Ecology Bibliography"/>
<meta name="twitter:description" content="Thanks to Kermyt Anderson, the Human Behavioral Ecology Bibliography (HBEB) has recently gone online. Eleanor Power has taken this text file and parsed it into a bibtex file, and from there it can be turned into an Endnote library or other bibliographic database format.
I&rsquo;m curious to know more about HBEB&rsquo;s use as a dataset in its own right, and since I&rsquo;ve been doing similar work with our field data here at MPI-EVA&rsquo;s new Department of Human Behavior, Ecology and Culture, I figured I could turn the lens on us at the same time as showcase the methods to interested parties."/>



<meta itemprop="name" content="Text Mining the Human Behavioral Ecology Bibliography">
<meta itemprop="description" content="Thanks to Kermyt Anderson, the Human Behavioral Ecology Bibliography (HBEB) has recently gone online. Eleanor Power has taken this text file and parsed it into a bibtex file, and from there it can be turned into an Endnote library or other bibliographic database format.
I&rsquo;m curious to know more about HBEB&rsquo;s use as a dataset in its own right, and since I&rsquo;ve been doing similar work with our field data here at MPI-EVA&rsquo;s new Department of Human Behavior, Ecology and Culture, I figured I could turn the lens on us at the same time as showcase the methods to interested parties."><meta itemprop="datePublished" content="2017-06-15T00:00:00+00:00" />
<meta itemprop="dateModified" content="2017-06-15T00:00:00+00:00" />
<meta itemprop="wordCount" content="1770"><meta itemprop="image" content="images/bret-head.jpg"/>
<meta itemprop="keywords" content="" />
<meta name="referrer" content="no-referrer-when-downgrade" />

  <link rel="stylesheet" href="/css/custom.css">
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>



<script async src="https://www.googletagmanager.com/gtag/js?id=G-4PXGB1H7X2"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-4PXGB1H7X2', { 'anonymize_ip': false });
}
</script>


<script>
 
(function () {
  const KEY = "theme";
  const stored = localStorage.getItem(KEY);
  const systemDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
  const theme = stored || (systemDark ? "dark" : "light");
  document.documentElement.setAttribute("data-theme", theme);
  
  document.documentElement.style.colorScheme = theme === "dark" ? "dark" : "light";
})();
</script>

<style>
   
  :root {
    --bg: #ffffff;
    --fg: #1a1a1a;
    --muted: #666666;
    --link: #0b5fff;
    --card: #f6f7f9;
    --border: #e6e8eb;

     
    --link-visited: #5a8cff;
    --code-bg: #f5f3ff;
    --code-fg: #222222;
  }
  
  html[data-theme="dark"] {
    --bg: #0e1113;
    --fg: #e6e6e6;
    --muted: #a0a0a0;
    --link: #8ab4ff;
    --card: #171a20;
    --border: #2a2f3a;

    --link-visited: #a3c2ff;
    --code-bg: #1c1a28;
    --code-fg: #e6e6e6;
  }

   
  @media (prefers-color-scheme: dark) {
    html:not([data-theme]) {
      --bg: #0e0f12;
      --fg: #e6e6e6;
      --muted: #a0a0a0;
      --link: #8ab4ff;
      --card: #171a20;
      --border: #2a2f3a;

      --link-visited: #a3c2ff;
      --code-bg: #1c1a28;
      --code-fg: #e6e6e6;
    }
  }
</style>


</head>

<body>
  <header><a href="/" class="title">
  <h2>Bret Alexander Beheim</h2>
</a>
<nav>
  <div class="nav-links"><a href="/">About</a>

<a href="/publications.html">Publications</a>

<a href="/people.html">People</a>

<a href="/software.html">Software</a>

<a href="/teaching.html">Teaching</a>

<a href="/blog">Blog</a>

</div>
  <div class="nav-toggle">
    
<label class="switch" aria-label="Toggle dark mode" title="Toggle dark mode">
  <input id="theme-toggle" type="checkbox">
  <span class="slider round"></span>
</label>

<style>
 
.switch {
  position: relative;
  display: inline-block;
  width: 50px;    
  height: 26px;
  vertical-align: middle;  
}

 
.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

 

 
.slider {
  position: absolute;
  cursor: pointer;
  inset: 0;
  background-color: #242424;
  transition: .4s;
}

 
.slider:before {
  content: "";
  position: absolute;
  height: 20px;
  width: 20px;
  left: 3px;
  bottom: 3px;
  background-color: #e3e3e3;
  transition: .4s;
}

input:checked + .slider { background-color: #e3e3e3; }
input:checked + .slider:before { background-color: #242424; transform: translateX(24px); }

 
.slider.round { border-radius: 26px; }
.slider.round:before { border-radius: 50%; }
</style>
  </div>
</nav>

<style>
nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
</style></header>
  <main>

<h1>Text Mining the Human Behavioral Ecology Bibliography</h1>
<p>
  <i>
    <time datetime='2017-06-15' pubdate>
      15 June, 2017
    </time>
  </i>
</p>

<content>
  <p>Thanks to Kermyt Anderson, the Human Behavioral Ecology Bibliography (HBEB) has recently gone online. Eleanor Power has taken this text file and parsed it into <a href="https://docs.google.com/document/d/1_noydOgcQ2fOUpkNOmx74o1_lw8KBHUsNyoYIvCHw2g/edit">a bibtex file</a>, and from there it can be turned into an Endnote library or other bibliographic database format.</p>
<p>I&rsquo;m curious to know more about HBEB&rsquo;s use as a dataset in its own right, and since I&rsquo;ve been doing similar work with our field data here at MPI-EVA&rsquo;s new <a href="http://www.eva.mpg.de/ecology/projects.html">Department of Human Behavior, Ecology and Culture</a>, I figured I could turn the lens on us at the same time as showcase the methods to interested parties.</p>
<p>Since this dataset will likely grow over time, having everything in one R script also means it can be re-used automatically as HBEB grows. So here goes:</p>
<h1 id="initial-processing">Initial Processing</h1>
<p>First, we need a tool that can parse *.bib files and load them into an R environment in a format we can manipulate. A Google search reveals a solution: the <code>ReadBib</code> function in package <code>RefManageR</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    hbeb_data &lt;- ReadBib(<span style="color:#a31515">&#34;./data/Human Behavioral Ecology Bibliography.bib&#34;</span>, 
        check=<span style="color:#00f">FALSE</span>)
</code></pre></div><pre tabindex="0"><code>## Unrecognized macro in Reyes-Garc{\'\i}a, Victoria
</code></pre><pre tabindex="0"><code>## Unrecognized macro in Manuel J. Mac{\'\i}a
</code></pre><pre tabindex="0"><code>## Unrecognized macro in Mart{\'\i} Orta-Mart{\'\i}nez
</code></pre><pre tabindex="0"><code>## Unrecognized macro in V. Reyes-Garc{\'\i}a
</code></pre><pre tabindex="0"><code>## Unrecognized macro in Victoria Reyes-Garc{\'\i}a
</code></pre><pre tabindex="0"><code>## Unrecognized macro in Martha Fr{\'\i}as-Armenta
</code></pre><p>As ReadBib loads the file into R, it displays some messages about inconsistencies in the bib syntax. We can reroute those messages to write to a file by using <code>sink</code> calls to inspect later at our leisure.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    zz &lt;- file(<span style="color:#a31515">&#34;./data/messages.txt&#34;</span>, open = <span style="color:#a31515">&#34;wt&#34;</span>)
    sink(file=zz, type=<span style="color:#a31515">&#34;message&#34;</span>)
    hbeb_data &lt;- ReadBib(<span style="color:#a31515">&#34;./data/Human Behavioral Ecology Bibliography.bib&#34;</span>, check=<span style="color:#00f">FALSE</span>)
    sink()
</code></pre></div><p>Having loaded the data, I need to turn it into one or more data frames to be able to do anything with it. I&rsquo;m not familar with the <code>BibEntry</code> class the data is now in, but it inherits the same behavior as basic R lists. I&rsquo;m going to apply some list methods I use in my [YAML to JSON to CSV pipeline]({% post_url 2017-02-12-hierarchical-data-in-plain-text %}) for processing field interviews.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    nullToNA &lt;- function(x) {
        x[sapply(x, is.null)] &lt;- <span style="color:#00f">NA</span>
        return(x)
    }

    hbeb_df &lt;- data.frame(
        key=unlist(hbeb_data$key),
        year=unlist(hbeb_data$year), 
        pages=unlist(nullToNA(hbeb_data$pages)), 
        volume=unlist(nullToNA(hbeb_data$volume)), 
        journal=unlist(nullToNA(hbeb_data$journal)), 
        title=unlist(nullToNA(hbeb_data$title)),
        type=unlist(nullToNA(hbeb_data$bibtype)),
        publisher=unlist(nullToNA(hbeb_data$publisher)),
        doi=unlist(nullToNA(hbeb_data$doi)),
        url=unlist(nullToNA(hbeb_data$url)),
        booktitle=unlist(nullToNA(hbeb_data$booktitle))
    )

    for(i in 1:ncol(hbeb_df)) hbeb_df[,i] &lt;- as.character(hbeb_df[,i])
</code></pre></div><p>To describe what the code block above is doing, the <code>unlist</code> function corrals the variables into simple vectors and the <code>data.frame</code> function column-binds them into a data frame. I wrote a new function, <code>nullToNA</code> so missing values are not dropped during this operation.</p>
<p>The result is a data frame with 1255 rows (the same length as the <code>hbeb_data</code> list) and the 11 columns we defined above. Each entry contains data associated with that citation: the year, the title, the DOI, etc., with the exception of the authors. That part is complicated because it lends itself to a [hierarchical data model]({% post_url 2017-02-12-hierarchical-data-in-plain-text %}), so I will save it for last.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    barplot(table(hbeb_df$year), main=<span style="color:#a31515">&#34;count by year of publication&#34;</span>, 
        border=<span style="color:#00f">NA</span>, col=barplot_color)

    abline(h=seq(0, 100, by=20), lty=2, col=col_alpha(<span style="color:#a31515">&#34;gray&#34;</span>, 0.6))
</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    type_tab &lt;- prop.table(table(hbeb_df$type))
    type_tab &lt;- floor(100*type_tab)
</code></pre></div><p>Of the 1255 publications in HBEB, 82 percent are articles, 15 percent are chapters in edited volumes, and 1 percent are books. Looking at the number of entries in HBEB through time, there&rsquo;s clearly fewer pubs since 2005, steadily declining up to the present.</p>
<p>Such questions are feasible, now that the data are in a usable (for me) format.</p>
<h1 id="what-journals-most-commonly-publish-human-behavioral-ecology-articles">What journals most commonly publish human behavioral ecology articles?</h1>
<p>If we count up the number of unique journals mentioned in the database, e.g. <code>length(unique(hbeb_df$journal))</code>, we initially see 184 names. But this is misleading: we can see from this list that there&rsquo;s a lot of alternative spellings which will make it difficult to accurately count up appearances<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. For example:</p>
<ul>
<li>&ldquo;Proceedings of the Royal Society B&rdquo;</li>
<li>&ldquo;Proceedings of the Royal Society B: Biological Science&rdquo;</li>
<li>&ldquo;Proceedings of the Royal Society B: Biological Sciences&rdquo;</li>
<li>&ldquo;Proceedings of the Royal Society Biology&rdquo;</li>
<li>&ldquo;Proceedings of the Royal Society of London: Biological Sciences&rdquo;</li>
<li>&ldquo;Proceedings of the Royal Society, Series B&rdquo;
and even</li>
<li>&ldquo;roceedings of the Royal Society, Series B&rdquo;</li>
</ul>
<p>There&rsquo;s probably a more elegant approach to data cleaning, but in situations like this, I just renaming the entries like so:</p>
<p>Let&rsquo;s make a backup copy, then apply the <code>gsub</code> command to eliminate strange characters.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    hbeb_df$journal_og &lt;- hbeb_df$journal
    hbeb_df$journal &lt;- iconv(hbeb_df$journal, to = <span style="color:#a31515">&#34;utf-8&#34;</span>)
    hbeb_df$journal &lt;- gsub(<span style="color:#a31515">&#34;\\{&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, hbeb_df$journal)
    hbeb_df$journal &lt;- gsub(<span style="color:#a31515">&#34;\\}&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, hbeb_df$journal)
    hbeb_df$journal &lt;- gsub(<span style="color:#a31515">&#34;\&#34;&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, hbeb_df$journal)
    hbeb_df$journal &lt;- gsub(<span style="color:#a31515">&#34;\\\\&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, hbeb_df$journal)
    hbeb_df$journal &lt;- gsub(<span style="color:#a31515">&#34;/&#39;&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, hbeb_df$journal)
</code></pre></div><p>Now for the renaming:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    old_names &lt;- c(<span style="color:#a31515">&#34;Proceedings of the Royal Society B: Biological Science&#34;</span>, 
        <span style="color:#a31515">&#34;Proceedings of the Royal Society B: Biological Sciences&#34;</span>,
        <span style="color:#a31515">&#34;Proceedings of the Royal Society Biology&#34;</span>,
        <span style="color:#a31515">&#34;Proceedings of the Royal Society of London: Biological Sciences&#34;</span>,
        <span style="color:#a31515">&#34;Proceedings of the Royal Society, Series B&#34;</span>,
        <span style="color:#a31515">&#34;roceedings of the Royal Society, Series B&#34;</span>)

    hbeb_df$journal[hbeb_df$journal %in% 
        old_names] &lt;- <span style="color:#a31515">&#34;Proceedings of the Royal Society B&#34;</span>
</code></pre></div><p>I&rsquo;ll do a similar operation for PNAS and a few other journals in the Rmarkdown code, but for clarity, it will not be not printed here.</p>
<p>This one is actually funny:</p>
<ul>
<li>&ldquo;Plos ONE&rdquo;</li>
<li>&ldquo;PLoS One&rdquo;</li>
<li>&ldquo;PLoS ONE&rdquo;</li>
<li>&ldquo;PLOS One&rdquo;</li>
<li>&ldquo;PLOS ONE&rdquo;</li>
</ul>
<p>We fix this one by standardizing capitalization. I&rsquo;ll use a function called <code>cw</code> which I got <a href="https://github.com/ropensci/wellknown/blob/master/R/zzz.R">here</a>.</p>
<p>With the journal names at least somewhat cleaned of duplicates, we can count 165 unique journals listed. We can see the most popular ten as a horizontal barplot:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    par(mar=c(5.1, 20, 4.1, 2.1))

    top_ten_journals &lt;- rev(sort(table(as.character(hbeb_df$journal[hbeb_df$type==<span style="color:#a31515">&#34;Article&#34;</span>]))))[1:10]

    barplot( rev(top_ten_journals), horiz=<span style="color:#00f">TRUE</span>, 
        las=1, xlab=<span style="color:#a31515">&#34;pub count&#34;</span>, border=<span style="color:#00f">NA</span>, col=barplot_color)

    abline(v=seq(0, 150, by=50), lty=2, col=col_alpha(<span style="color:#a31515">&#34;gray&#34;</span>, 0.6))
</code></pre></div><p>The most popular journal in the database is Human Nature (165 publications), followed by Evolution And Human Behavior (160 publications) and Current Anthropology (76 publications). In total, these ten journals account for 63 percent of all articles in HBEB.</p>
<h1 id="identifying-keywords-in-titles">Identifying keywords in titles</h1>
<p>I&rsquo;ve always wanted to make a word cloud, and the title of each citation can be mined for common words. I&rsquo;m going to use the packages and methods outlined <a href="https://www.r-bloggers.com/building-wordclouds-in-r/">here</a>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    <span style="color:#008000"># load needed libraries</span>
    library(tm)
    library(SnowballC)

    <span style="color:#008000"># remove strange characters from the title input</span>
    title_strings &lt;- iconv(hbeb_df$title, to = <span style="color:#a31515">&#34;utf-8&#34;</span>)
    title_strings &lt;- gsub(<span style="color:#a31515">&#34;\\{&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, title_strings)
    title_strings &lt;- gsub(<span style="color:#a31515">&#34;\\}&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, title_strings)
    title_strings &lt;- gsub(<span style="color:#a31515">&#34;\&#34;&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, title_strings)
    title_strings &lt;- gsub(<span style="color:#a31515">&#34;\\\\&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, title_strings)
    title_strings &lt;- gsub(<span style="color:#a31515">&#34;/&#39;&#34;</span>, <span style="color:#a31515">&#34;&#34;</span>, title_strings)

    <span style="color:#008000"># use tm&#39;s corpus class to process the text</span>
    d_cor &lt;- Corpus(VectorSource(title_strings))
    d_cor &lt;- tm_map(d_cor, PlainTextDocument)
    d_cor &lt;- tm_map(d_cor, removePunctuation)
    d_cor &lt;- tm_map(d_cor, tolower)
    d_cor &lt;- tm_map(d_cor, content_transformer(gsub), 
        pattern = <span style="color:#a31515">&#34;evolutionary&#34;</span>, replacement = <span style="color:#a31515">&#34;evolution&#34;</span>)
    d_cor &lt;- tm_map(d_cor, removeWords, c(<span style="color:#a31515">&#39;the&#39;</span>, <span style="color:#a31515">&#39;among&#39;</span>, 
        <span style="color:#a31515">&#39;human&#39;</span>, <span style="color:#a31515">&#39;evolution&#39;</span>, stopwords(<span style="color:#a31515">&#39;english&#39;</span>)))
    d_cor &lt;- Corpus(VectorSource(d_cor))
</code></pre></div><p>Note that I took out the words &ldquo;the&rdquo;, &ldquo;evolution&rdquo;, &ldquo;evolutionary&rdquo; and &ldquo;human&rdquo;, since those are the most common and least informative. Now we make a wordcloud with the <code>wordcloud</code> function in the <code>wordcloud</code> library. Wordcloud.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    <span style="color:#008000"># plot</span>
    library(wordcloud)
    library(RColorBrewer)

    cloud_cols &lt;- brewer.pal(8, <span style="color:#a31515">&#34;Dark2&#34;</span>)

    wordcloud(d_cor, max.words=100, random.order=<span style="color:#00f">FALSE</span>, colors=cloud_cols)
</code></pre></div><!-- raw HTML omitted -->
<h1 id="identifying-authors-through-relational-tables">Identifying authors through relational tables</h1>
<p>The author data introduces a common complication in behavioral databases. That is, the author data are not easy to fit in a flat file configuration, because each citation has a variable number of authors. You might be tempted to simply glom them onto the <code>hbeb_df</code> table as <code>author_given_name_1</code>, <code>author_family_name_1</code>, <code>author_given_name_2</code>, <code>author_family_name_2</code>, etc., but <strong>this is a terrible idea and you should stop doing it.</strong> Comes from a tradition of manipulating data tables by hand, wanting to be able to see the entries in a wide format.</p>
<p>We will see there is one citation with 23 authors; creating dozens or hundreds of mostly-empty columns is madness. Rather, we <strong>make the data relational</strong>, by creating an authors subtable linked to the main table by the citation key. Most importantly this is how we actually want to use the data in analyses.</p>
<p>By inspection:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    str(hbeb_data[[1]]$author)
</code></pre></div><pre tabindex="0"><code>## Class 'person'  hidden list of 1
##  $ :List of 5
##   ..$ given  : chr [1:2] &quot;Kermyt&quot; &quot;G.&quot;
##   ..$ family : chr &quot;Anderson&quot;
##   ..$ role   : NULL
##   ..$ email  : NULL
##   ..$ comment: NULL
</code></pre><p>The <code>person</code> class in RefManageR is essentially a list with five fixed slots. The following extraction code is quick and dirty but should serve. I begin by initializing a new data frame, which will grow <em>vertically</em>, one row added for each author in each citation. To keep things sane, I&rsquo;ll add the citation key of the paper in the rows of each author of that paper.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    authors &lt;- data.frame( citation_key = character(0), 
        given_name = character(0), family_name = character(0) )

    for(i in 1:length(hbeb_data)){
        if(!is.null(hbeb_data[[i]]$author)){ <span style="color:#008000"># skip if citation has no author</span>
            for(j in 1:length(hbeb_data[[i]]$author)){
                add &lt;- data.frame(
                    citation_key = hbeb_data[[i]]$key, 
                    given_name = paste(hbeb_data[[i]]$author[j]$given, collapse=<span style="color:#a31515">&#34; &#34;</span>), 
                    family_name = hbeb_data[[i]]$author[j]$family,
                    author_number = j
                )
                authors &lt;- rbind(add, authors)
            }
        }
    }

    for(i in 1:ncol(authors)) authors[,i] &lt;- as.character(authors[,i])
</code></pre></div><p>Now we have a long-oriented table with 2942 author-citation entries, and (unlike a wide table) we can elegantly calculate useful statistics from this relational data structure. First, a let&rsquo;s count up how many coauthors on each citation:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    hbeb_df$author_count &lt;- table(authors$citation_key)[hbeb_df$key]

    par(mar=c(5.1, 4.1, 4.1, 2.1))
    par(mfrow=c(2,2))
    barplot(prop.table(table(hbeb_df$author_count)), las=1, 
        xlab=<span style="color:#a31515">&#34;number of coauthors&#34;</span>, ylab=<span style="color:#a31515">&#34;frequency&#34;</span>, 
        main=<span style="color:#a31515">&#34;all publications&#34;</span>, border=<span style="color:#00f">NA</span>, col=barplot_color, 
        xlim=c(0, 7.5), ylim=c(0, 0.45))
    barplot(
        prop.table(table(hbeb_df$author_count[hbeb_df$type==<span style="color:#a31515">&#34;Article&#34;</span>])), 
        las=1, xlab=<span style="color:#a31515">&#34;number of coauthors&#34;</span>, ylab=<span style="color:#a31515">&#34;frequency&#34;</span>, 
        main=<span style="color:#a31515">&#34;articles&#34;</span>, border=<span style="color:#00f">NA</span>, col=barplot_color, 
        xlim=c(0, 7.5), ylim=c(0, 0.45))
    barplot(
        prop.table(table(hbeb_df$author_count[hbeb_df$type==<span style="color:#a31515">&#34;Book&#34;</span>])), 
        las=1, xlab=<span style="color:#a31515">&#34;number of coauthors&#34;</span>, ylab=<span style="color:#a31515">&#34;frequency&#34;</span>, 
        main=<span style="color:#a31515">&#34;books&#34;</span>, border=<span style="color:#00f">NA</span>, col=barplot_color, ylim=c(0, 0.45))
    barplot(prop.table(table(hbeb_df$author_count[hbeb_df$type==<span style="color:#a31515">&#34;InCollection&#34;</span>])), 
        las=1, xlab=<span style="color:#a31515">&#34;number of coauthors&#34;</span>, ylab=<span style="color:#a31515">&#34;frequency&#34;</span>, 
        main=<span style="color:#a31515">&#34;chapters&#34;</span>, border=<span style="color:#00f">NA</span>, col=barplot_color, 
        xlim=c(0, 7.5), ylim=c(0, 0.45))
</code></pre></div><!-- raw HTML omitted -->
<p>Before that, though, we must solve a common problem. Consider the following entry for Peter J. Richerson:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    unique(authors[authors$family_name==<span style="color:#a31515">&#34;Richerson&#34;</span>, c(<span style="color:#a31515">&#34;given_name&#34;</span>, <span style="color:#a31515">&#34;family_name&#34;</span>)])
</code></pre></div><pre tabindex="0"><code>##      given_name family_name
## 39     Peter J.   Richerson
## 603       Peter   Richerson
## 2099      P. J.   Richerson
## 2468         P.   Richerson
</code></pre><p>The given names are non-standardized! So people appear under multiple versions of their names.</p>
<p>I&rsquo;m going to try a quick match using the first letter of <code>given_name</code>. This can be dangerous, since it will collide two people with the same last name and the same first initial, but (hopefully) it works for now.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    authors$author_key &lt;- paste(
        substr(authors$given_name, 1, 1), authors$family_name
    )
</code></pre></div><p>The author_key variable will allow us to create a unique table of authors, and count up how many times each appears.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    author_pk &lt;- unique(authors$author_key)
    count &lt;- as.numeric(table(authors$author_key)[author_pk])
    given_name &lt;- authors$given_name[match(author_pk, authors$author_key)]
    family_name &lt;- authors$family_name[match(author_pk, authors$author_key)]

    author_register &lt;- data.frame( author_pk, given_name, family_name, count )

    author_register$count_firstauthor &lt;- <span style="color:#00f">NA</span>
    for(i in 1:nrow(author_register)){
        author_register$count_firstauthor[i] &lt;- sum(
            authors$author_key == author_register$author_pk[i] 
            &amp; authors$author_number==1
        )
    }
</code></pre></div><p>And we have our answer: there are (approximately) 1137 unique authors in the HBEB. Like with the journals, we can calculate how many times each author appears in the database. Below I display a sorted count of the top forty authors in HBEB, by the number of publications listed.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">    par(mar=c(5.1, 10, 4.1, 2.1))

    o &lt;- rev(order(author_register$count))
    author_register &lt;- author_register[o,]

    barplot( author_register$count[1:40], horiz=<span style="color:#00f">TRUE</span>, 
        las=1, xlab=<span style="color:#a31515">&#34;pub count&#34;</span>, border=<span style="color:#00f">NA</span>, 
        col=barplot_color, names.arg=author_register$author_pk[1:40])
    abline(v=seq(0, 50, by=10), lty=2, col=col_alpha(<span style="color:#a31515">&#34;gray&#34;</span>, 0.6))
</code></pre></div><!-- raw HTML omitted -->
<h2 id="footnotes">Footnotes</h2>
<hr>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>We can also spot errors, e.g. the same book appears twice under <code>CronkLeech2013</code> and <code>CronkLeech2012</code>.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

</content>
<p>
  
</p>

    
  </main>
  <footer>


<script>
(function () {
  const KEY = "theme";
  const el = document.getElementById("theme-toggle");
  if (!el) return;

  const getTheme = () => document.documentElement.getAttribute("data-theme") || "light";
  const setTheme = (t) => {
    document.documentElement.setAttribute("data-theme", t);
    document.documentElement.style.colorScheme = t === "dark" ? "dark" : "light";
    localStorage.setItem(KEY, t);
  };

  
  el.checked = getTheme() === "dark";

  
  el.addEventListener("change", () => setTheme(el.checked ? "dark" : "light"));

  
  
  const stored = localStorage.getItem(KEY);
  if (!stored && window.matchMedia) {
    const mq = window.matchMedia("(prefers-color-scheme: dark)");
    mq.addEventListener?.("change", (e) => {
      setTheme(e.matches ? "dark" : "light");
      el.checked = e.matches;
    });
  }
})();
</script>
</footer>

    
</body>

</html>
